# 银行客群智能咨询助手 - 交互场景梳理

## 📋 项目交互场景总览

### 一、左侧面板交互（LeftPanel）

**关键词：`left-panel`**

#### 1.1 我的客群列表
- **点击客群项** → 触发查询分析
- **勾选客群** → 多选（最多3个），用于对比
- **刷新按钮** → 刷新客群数据
- **删除按钮** → 删除客群
- **对比按钮** → 对比选中的2-3个客群（仅当选中≥2个时激活）

#### 1.2 历史对话列表
- **点击历史记录** → 恢复对话上下文
- **删除历史记录** → 删除该条对话

#### 1.3 新建分析任务
- **点击"新建分析任务"按钮** → 创建新对话

---

### 二、中间对话区域交互（Chat Interface）

**关键词：`chat-interface`**

#### 2.1 消息输入
- **输入框输入文字** → 输入查询内容
- **按回车键** → 发送消息
- **点击发送按钮** → 发送消息

#### 2.2 用户消息气泡
- **显示用户输入内容** → 蓝色气泡

#### 2.3 AI消息类型

**关键词：`ai-message-customer-cards`**
- **客户卡片消息**（message_type: 'customer_cards'）
  - **点击卡片** → 在右侧面板展开客户详情
  - **展开"查看AI推理步骤"** → 显示推理步骤详情

**关键词：`ai-message-segment-result`**
- **客群查询结果消息**（message_type: 'segment_result'）
  - **点击"保存为客群"按钮** → 弹出保存客群模态框
  - **点击客户列表项** → 在右侧面板展开该客户详情

**关键词：`ai-message-segment-comparison`**
- **客群对比结果消息**（message_type: 'segment_comparison'）
  - 显示对比表格和核心洞察

**关键词：`ai-message-system`**
- **系统消息**（message_type: 'system'）
  - 显示系统提示信息

**关键词：`ai-message-clarification`**
- **澄清消息**（message_type: 'clarification'）
  - 模糊查询时提供选项引导

---

### 三、高级筛选交互（InlineFilter）

**关键词：`inline-filter`**

#### 3.1 筛选条件管理
- **添加筛选条件** → 新增一个条件行
- **删除筛选条件** → 删除指定条件行（至少保留1个）
- **修改字段** → 选择筛选字段（授信使用率、行业、地区等）
- **修改操作符** → 选择比较操作符（>、>=、=、<=、<、包含、不包含）
- **修改值** → 输入或选择筛选值

#### 3.2 筛选操作
- **点击"取消"按钮** → 关闭筛选面板
- **点击"应用筛选"按钮** → 应用筛选条件并执行查询

---

### 四、保存客群模态框交互（Save Segment Modal）

**关键词：`save-segment-modal`**

#### 4.1 保存客群
- **输入客群名称** → 命名客群
- **点击确认** → 保存客群到左侧"我的客群"
- **点击取消/关闭** → 关闭模态框

---

### 五、右侧详情面板交互（RightPanel）

**关键词：`right-panel`**

#### 5.1 面板操作
- **点击关闭按钮（X）** → 关闭详情面板
- **拖拽面板边缘** → 调整面板宽度（300px - 800px）

#### 5.2 模块折叠/展开
- **点击模块标题** → 折叠/展开对应模块
- **模块包括**：
  - 基础画像
  - 财务与授信
  - 风险预警
  - 关系图谱
  - 产品覆盖
  - 互动轨迹

---

### 六、数据流交互

**关键词：`data-flow`**

#### 6.1 模糊查询检测
- **输入模糊查询**（如"找一些好客户"）→ 自动弹出高级筛选面板

#### 6.2 客户详情加载
- **点击客户卡片/列表项** → 加载客户详情到右侧面板
- **客户详情数据来源** → mockData.getMockCustomerProfile()

#### 6.3 客群数据刷新
- **点击刷新按钮** → 重新执行客群查询

#### 6.4 客群对比
- **选中多个客群** → 点击对比按钮 → 生成对比报告

---

## 🎯 交互元素关键词汇总表

| 交互场景 | 关键词 | 对应组件/位置 |
|---------|--------|--------------|
| 左侧面板 | `left-panel` | [LeftPanel.tsx](components/LeftPanel.tsx) |
| 我的客群列表 | `left-panel-segments` | LeftPanel - 我的客群区域 |
| 历史对话列表 | `left-panel-history` | LeftPanel - 历史对话区域 |
| 客群对比 | `segment-compare` | LeftPanel - 对比按钮 |
| 对话区域 | `chat-interface` | [App.tsx](App.tsx) - 中间区域 |
| 消息输入 | `message-input` | App.tsx - 输入框区域 |
| 客户卡片消息 | `ai-message-customer-cards` | App.tsx - customer_cards类型消息 |
| 客群结果消息 | `ai-message-segment-result` | App.tsx - segment_result类型消息 |
| 客群对比消息 | `ai-message-segment-comparison` | App.tsx - segment_comparison类型消息 |
| 高级筛选 | `inline-filter` | [InlineFilter.tsx](components/InlineFilter.tsx) |
| 保存客群模态框 | `save-segment-modal` | App.tsx - 保存客群弹窗 |
| 右侧详情面板 | `right-panel` | [RightPanel.tsx](components/RightPanel.tsx) |
| 面板宽度调整 | `right-panel-resize` | App.tsx - 拖拽调整宽度 |
| 模块折叠展开 | `right-panel-section-toggle` | RightPanel - 各模块标题 |

---

## 💡 使用建议

当你需要修改某个交互逻辑时，可以使用上述关键词快速定位：

**示例：**
- "修改 `left-panel-segments` 的客群列表交互" → 修改左侧客群列表
- "调整 `right-panel-resize` 的拖拽逻辑" → 修改右侧面板宽度调整
- "优化 `inline-filter` 的筛选条件管理" → 修改高级筛选组件
- "增强 `ai-message-customer-cards` 的卡片交互" → 修改客户卡片消息展示

这样我就能快速找到对应的代码位置，帮你修改交互逻辑。

---

## 📂 组件文件结构

```
components/
├── LeftPanel.tsx          # 左侧面板组件
├── RightPanel.tsx         # 右侧详情面板组件
├── InlineFilter.tsx       # 高级筛选组件
├── CustomerCard.tsx       # 客户卡片组件
└── SegmentAnalysis.tsx    # 客群分析组件

App.tsx                    # 主应用组件（包含对话区域）
types.ts                   # 类型定义
mockData.ts                # 模拟数据
```

---

## 🔧 关键交互逻辑说明

### 模糊查询识别
系统会自动识别模糊查询模式，包括：
- "找一些.*客户"
- "找.*好客户"
- "筛选.*客户"
- "查找.*客户"
- "推荐.*客户"
- "优质客户"
- "潜力客户"
- "重点客户"

识别到模糊查询后，会自动弹出高级筛选面板。

### 客群对比流程
1. 在左侧"我的客群"中勾选2-3个客群
2. 点击"对比"按钮
3. 系统生成客群对比报告
4. 对比结果在对话区域显示

### 客户详情查看
1. 在对话中点击客户卡片或客户列表项
2. 右侧面板滑出显示客户详情
3. 可拖拽调整面板宽度
4. 点击关闭按钮或选择其他客户可切换/关闭详情

### 保存客群
1. 执行客群查询后，点击"保存为客群"按钮
2. 输入客群名称
3. 保存后客群自动添加到左侧"我的客群"列表
